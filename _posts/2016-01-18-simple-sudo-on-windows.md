---
layout: article
title: "Простое решения для привилегированного запуска скриптов для Windows"
categories: tips
tags:
- batch
- windows
teaser: teaser_03.jpg
---

Нередко в повседневной работе возникает необходимость запустить какой-нибудь скрипт в из-под администратора. В *nix'ах для этого принято использовать **sudo**. Ниже я покажу как реализовать похожий функционал для Windows. 

___

Копипастим этот код в любимый текстовый редактор:

{% highlight bat %} 
@echo Set objShell = CreateObject("Shell.Application") > %temp%\sudo.tmp.vbs
@echo args = Right("%*", (Len("%*") - Len("%1"))) >> %temp%\sudo.tmp.vbs
@echo objShell.ShellExecute "%1", args, "", "runas" >> %temp%\sudo.tmp.vbs
@cscript %temp%\sudo.tmp.vbs
{% endhighlight %}


Вот [тут](https://gist.github.com/kapb14/73121937ad36a50de271) лежит публичный Gist с этим кодом.


Сохраняем его как файл с названием **sudo.cmd**. 

И кладём этот файлик куда-нибудь в **%PATH%**. 


> Чтобы _далеко не ходить_, можно сохранить этот файл в свою домашнюю директорию (%USERPROFILE%) - она уже есть в переменной PATH вашего пользователя.


> Чтобы узнать какие папки находятся в **%PATH%**, можно набрать в консоли (cmd.exe) 
	`echo %PATH%`

> Чтобы добавить нужную папку в **%PATH%** (например, у меня в домашней директории есть папка "PATH" в которую я кидаю часто используемые portable-утилиты), можно открыть окно свойств системы (WIN+PAUSE), на вкладке "Дополнительно" нажать кнопку "Переменные среды", в разделе "Системные переменные" выделить "PATH" и нажать кнопку "Изменить". И через точку с запятой прописать путь к папке без кавычек.



Теперь можно делать например так:

    [Win+R]
    sudo cmd

Или так:

    sudo \\share\MyAwesomeScript.ps1

Или, например, так:

	[Win+R]
	sudo notepad    


_Profit!_

---
